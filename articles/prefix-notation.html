<!DOCTYPE html>
<!---
 "He felt that his whole life was some kind of dream
   and he sometimes wondered whose it was
     and whether they were enjoying it."
      
              --Douglas Adams, 'The Hitchhiker's Guide to the Galaxy'
---->
<html>
<head>
  <meta charset="utf-8">
  <title>A concise prefix notation calculator in Python - Allen Guo</title>
  <meta name="author" content="Allen Guo">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="../css/monokai-sublime.css">
  <link rel="stylesheet" href="../css/lightbox.css">
  <link rel="icon" type="image/png" href="../img/favicon.png">
  <style>
  .article-top {
    background-color: #315C6C;
  }
  </style>
</head>
<body>
<div class="article-top hidden-sm hidden-xs">
<div class="header-text">
<a href="/">allen guo</a>
<span class="header-right">
<a href="/#about">about me</a>
<a href="https://github.com/guoguo12" target="_blank">github</a>
</span>
</div>
</div>
<div class="article-top-placeholder hidden-sm hidden-xs">
<!-- Prevents top from being white as image loads. -->
</div>

<div class="article">
<h2>A concise prefix notation calculator in Python</h2>
<span class="byline">Published 1 November 2015 &mdash; 5 minute read
</span>

<div class="article-body">
<p>
Suppose we want to write a calculator that can evaluate math expressions of the form

<pre class="scheme"><code>(operator argument1 argument2)</code></pre>
<p>
where each argument is either a number or a math expression of the same form.
<p>
For example, <code>(+ 1 2)</code> evaluates to 3, as does <code>(- (+ 4 1) 2)</code>.
We say an expression like this is written in <b>prefix notation</b>.
If you've worked in Lisp before, you know what this is.
<p>
The typical process of parsing prefix notation involves breaking the input into tokens, assembling an abstract syntax tree (AST), then evaluating using recursion. This works very well, and can easily be extended to include more powerful Lisp-y features like environments and mutation.
<p>
Peter Norvig's classic <a href="http://norvig.com/lispy.html" target="_blank">"How to Write a Lisp Interpreter in Python"</a> uses this method. The main parsing procedure converts the input expression into a nested list:

<pre class="python"><code>>>> parse('(+ 1 (- 2 3))')
['+', 1, ['-', 2, 3]]
</code></pre>
<p>
This list is then fed to the <code>eval</code> procedure. It evaluates an expression by first evaluating the arguments, then applying the operator to them:
<pre class="python"><code>>>> eval(['+', 1, ['-', 2, 3]])
0
</code></pre>
<p>
(The addition symbol <code>'+'</code> is eventually converted into Python's <code>operator.add</code>.)
<p>
This process works well for evaluating prefix notation expressions in general. But if we're not looking to write a full-blown Lisp, can we be more simple?

<h3>Regex to the rescue</h3>
<p>
<a href="https://en.wikipedia.org/wiki/Regular_expression" target="_blank">Regular expressions</a> are great.
We can use them to search and match for patterns in strings.

</div>

<hr>

If you liked this, you might also enjoy my <a href="/#articles">other works</a>.
<p>
<i><span class="byline">
Top photo (CC-BY-SA) by Jimmy Wales.
</span></i>

</div>
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="../js/highlight.pack.js"></script>
<script src="../js/lightbox.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49126820-1', 'auto');
  ga('send', 'pageview');

  $('a').click(function() {
    ga('send', 'event', 'homepage', 'link', $(this).attr('href'));
  });

</script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
